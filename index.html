<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MISSJO Controller</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
      color: #eee;
      min-height: 100vh;
      padding: 20px;
    }
    .container { max-width: 700px; margin: 0 auto; }
    
    .header-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
    .header-title { color: #00d9ff; font-size: 20px; font-weight: 700; cursor: default; user-select: none; }
    .header-title .missjo { color: #ffdd00; font-size: 26px; font-weight: 800; }
    .header-title .from { color: #00d9ff; font-size: 14px; font-weight: 600; }
    .header-buttons { display: flex; gap: 8px; }
    .lang-btn {
      padding: 8px 12px; border: 2px solid transparent; border-radius: 8px;
      background: rgba(255,255,255,0.1); cursor: pointer; font-size: 18px; transition: all 0.2s;
    }
    .lang-btn:hover { background: rgba(255,255,255,0.2); }
    .lang-btn.active { border-color: #00d9ff; background: rgba(0,217,255,0.2); }
    .info-btn {
      padding: 8px 14px; border: none; border-radius: 8px;
      background: linear-gradient(135deg, #ff6b9d, #ff4081);
      color: white; cursor: pointer; font-size: 14px; font-weight: 600;
    }
    
    .card {
      background: rgba(22, 33, 62, 0.9); border-radius: 16px;
      padding: 20px; margin-bottom: 16px; border: 1px solid rgba(255,255,255,0.1);
    }
    .card-title {
      font-size: 14px; color: #888; text-transform: uppercase;
      letter-spacing: 1px; margin-bottom: 15px;
      display: flex; justify-content: space-between; align-items: center;
    }
    
    .status-bar { display: flex; align-items: center; justify-content: space-between; }
    .status { display: flex; align-items: center; gap: 10px; }
    .status-dot { width: 10px; height: 10px; border-radius: 50%; background: #ff4757; box-shadow: 0 0 10px #ff4757; }
    .status-dot.connected { background: #2ed573; box-shadow: 0 0 10px #2ed573; }
    
    .btn {
      padding: 12px 24px; border: none; border-radius: 10px;
      font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.2s;
    }
    .btn:hover { transform: translateY(-2px); }
    .btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
    .btn-connect { background: linear-gradient(135deg, #00d9ff, #0090ff); color: #000; }
    .btn-disconnect { background: linear-gradient(135deg, #ff4757, #ff3344); color: #fff; }
    .btn-row { display: flex; gap: 10px; margin-top: 10px; }
    .btn-load-device {
      background: linear-gradient(135deg, #ff6b9d, #ff4081); color: #fff;
      flex: 3; padding: 15px; font-size: 14px;
    }
    .btn-save {
      background: linear-gradient(135deg, #2ed573, #1abc54); color: #000;
      flex: 7; padding: 15px; font-size: 14px;
    }
    .btn-save.unsaved { animation: pulse 1.5s infinite; }
    @keyframes pulse {
      0%, 100% { box-shadow: 0 0 0 0 rgba(46, 213, 115, 0.5); }
      50% { box-shadow: 0 0 15px 5px rgba(46, 213, 115, 0.3); }
    }
    .unsaved-badge { display: inline-block; background: #ffa502; color: #000; font-size: 11px; padding: 2px 8px; border-radius: 10px; margin-left: 10px; }
    .hidden { display: none !important; }
    
    /* í”„ë¦¬ì…‹ ê·¸ë¦¬ë“œ */
    .preset-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; }
    .preset-box {
      padding: 12px 8px; border: 2px solid rgba(255,255,255,0.15); border-radius: 12px;
      background: rgba(0,0,0,0.2); cursor: pointer; text-align: center; transition: all 0.2s;
    }
    .preset-box:hover { border-color: #00d9ff; background: rgba(0,217,255,0.1); }
    .preset-box.selected { border-color: #2ed573; background: rgba(46,213,115,0.15); }
    .preset-icon { font-size: 24px; margin-bottom: 5px; }
    .preset-name { font-size: 10px; color: #aaa; }
    .preset-actions { display: flex; gap: 10px; margin-top: 15px; }
    .preset-actions .btn { flex: 1; padding: 10px; }
    .btn-load { background: linear-gradient(135deg, #00d9ff, #0090ff); color: #000; }
    
    /* ë²„íŠ¼ ê·¸ë¦¬ë“œ */
    .button-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }
    .button-box {
      padding: 15px; border: 2px solid rgba(255,255,255,0.15); border-radius: 12px;
      background: rgba(0,0,0,0.2); cursor: pointer; transition: all 0.2s; user-select: none;
    }
    .button-box:hover { border-color: rgba(255,255,255,0.3); }
    .button-box.selected { border-color: #00d9ff; background: rgba(0,217,255,0.15); }
    .button-box.virtual-active { border-color: #2ed573; background: rgba(46,213,115,0.2); transform: scale(0.97); }
    .button-box-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
    .button-number { font-size: 16px; font-weight: 700; color: #00d9ff; }
    .button-mode-badge { font-size: 12px; padding: 4px 10px; border-radius: 6px; background: rgba(255,255,255,0.1); color: #888; font-weight: 600; }
    .button-mode-badge.single { background: rgba(255,165,2,0.2); color: #ffa502; }
    .button-mode-badge.double { background: rgba(0,217,255,0.2); color: #00d9ff; }
    .button-info { font-size: 11px; color: #888; line-height: 1.8; }
    .button-info-row { display: flex; align-items: flex-start; gap: 5px; margin-bottom: 2px; }
    .button-info-label { color: #666; min-width: 18px; font-weight: 600; }
    .button-info-value { color: #ccc; word-break: break-word; }
    
    .virtual-hint {
      font-size: 11px; color: #2ed573; font-weight: 600;
      background: rgba(46,213,115,0.15); padding: 4px 10px; border-radius: 12px;
      animation: hintPulse 2s infinite;
    }
    @keyframes hintPulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.6; }
    }
    .virtual-toggle { display: flex; align-items: center; gap: 10px; font-size: 13px; color: #888; }
    .toggle { position: relative; width: 44px; height: 24px; }
    .toggle input { opacity: 0; width: 0; height: 0; }
    .toggle-slider {
      position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(255,255,255,0.2); border-radius: 24px; transition: 0.3s;
    }
    .toggle-slider:before {
      position: absolute; content: ""; height: 18px; width: 18px; left: 3px; bottom: 3px;
      background: white; border-radius: 50%; transition: 0.3s;
    }
    .toggle input:checked + .toggle-slider { background: #2ed573; }
    .toggle input:checked + .toggle-slider:before { transform: translateX(20px); }
    
    /* ì„¤ì • */
    .mode-select { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
    .mode-btn {
      padding: 15px; border: 2px solid rgba(255,255,255,0.2); border-radius: 12px;
      background: transparent; color: #888; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.2s;
    }
    #modeSingle.active { border-color: #ffa502; color: #ffa502; background: rgba(255,165,2,0.15); }
    #modeDouble.active { border-color: #00d9ff; color: #00d9ff; background: rgba(0,217,255,0.1); }
    
    .slider-group { margin: 15px 0; }
    .slider-box {
      background: rgba(0,0,0,0.4);
      border: 2px solid rgba(0,217,255,0.3);
      border-radius: 14px;
      padding: 18px;
      position: relative;
      overflow: hidden;
    }
    .slider-box::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, #00d9ff, #ff6b9d);
    }
    .slider-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }
    .slider-title {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 15px;
      color: #fff;
      font-weight: 600;
    }
    .slider-title .icon {
      font-size: 22px;
      filter: drop-shadow(0 0 5px rgba(0,217,255,0.5));
    }
    .slider-value-box {
      background: rgba(0,217,255,0.15);
      border: 1px solid rgba(0,217,255,0.4);
      border-radius: 8px;
      padding: 6px 14px;
    }
    .slider-value { font-size: 18px; font-weight: 700; color: #00d9ff; }
    input[type="range"] {
      width: 100%;
      height: 10px;
      border-radius: 5px;
      background: linear-gradient(90deg, rgba(0,217,255,0.3), rgba(255,107,157,0.3));
      appearance: none;
      outline: none;
    }
    input[type="range"]::-webkit-slider-thumb {
      appearance: none;
      width: 24px;
      height: 24px;
      background: linear-gradient(135deg, #00d9ff, #0090ff);
      border-radius: 50%;
      cursor: pointer;
      box-shadow: 0 0 12px rgba(0,217,255,0.6);
      border: 2px solid #fff;
    }
    
    .action-card { background: rgba(0,0,0,0.2); border-radius: 12px; padding: 15px; margin-top: 10px; }
    .action-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
    .action-title { font-size: 16px; font-weight: 600; }
    .action-title.short { color: #2ed573; }
    .action-title.long { color: #ffa502; }
    .action-disabled { opacity: 0.4; pointer-events: none; }
    
    .form-group { margin-bottom: 12px; }
    .form-label { display: block; font-size: 12px; color: #888; margin-bottom: 6px; }
    select, input[type="number"] {
      width: 100%; padding: 10px; border: 1px solid rgba(255,255,255,0.2);
      border-radius: 8px; background: rgba(0,0,0,0.3); color: #fff; font-size: 13px; outline: none;
    }
    select:focus, input[type="number"]:focus { border-color: #00d9ff; }
    .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
    .form-row-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; }
    
    .macro-step { background: rgba(0,0,0,0.2); border-radius: 10px; padding: 12px; margin-bottom: 10px; border-left: 3px solid #ff6b9d; }
    .macro-step.disabled { opacity: 0.5; border-left-color: #444; }
    .macro-step-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
    .macro-step-title { font-size: 13px; font-weight: 600; color: #ff6b9d; }
    .macro-step.disabled .macro-step-title { color: #666; }
    .modifier-row { display: flex; gap: 15px; margin-top: 10px; }
    .modifier-check { display: flex; align-items: center; gap: 5px; font-size: 12px; color: #aaa; }
    .modifier-check input { width: 16px; height: 16px; accent-color: #00d9ff; }
    
    .log { background: rgba(0,0,0,0.4); border-radius: 8px; padding: 12px; height: 100px; overflow-y: auto; font-family: monospace; font-size: 11px; }
    .log-entry { padding: 2px 0; border-bottom: 1px solid rgba(255,255,255,0.05); }
    .log-entry.rx { color: #2ed573; }
    .log-entry.tx { color: #ffa502; }
    .log-entry.info { color: #747d8c; }
    
    .modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1000; justify-content: center; align-items: center; padding: 20px; }
    .modal-overlay.show { display: flex; }
    .modal { background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); border-radius: 20px; max-width: 500px; width: 100%; max-height: 90vh; overflow-y: auto; border: 1px solid rgba(255,255,255,0.1); }
    .modal-header { display: flex; justify-content: space-between; align-items: center; padding: 20px; border-bottom: 1px solid rgba(255,255,255,0.1); }
    .modal-title { font-size: 20px; font-weight: 700; color: #00d9ff; }
    .modal-close { background: none; border: none; color: #888; font-size: 28px; cursor: pointer; }
    .modal-body { padding: 20px; }
    .info-section { margin-bottom: 25px; }
    .info-section-title { font-size: 14px; color: #888; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 12px; }
    .profile-area { display: flex; gap: 20px; align-items: center; }
    .profile-photo { width: 80px; height: 80px; border-radius: 50%; background: rgba(255,255,255,0.1); display: flex; align-items: center; justify-content: center; color: #666; font-size: 11px; text-align: center; border: 3px solid #00d9ff; overflow: hidden; }
    .profile-photo img { width: 100%; height: 100%; object-fit: cover; }
    .profile-name { font-size: 18px; font-weight: 600; margin-bottom: 5px; }
    .profile-desc { font-size: 12px; color: #888; }
    .profile-email { font-size: 11px; margin-top: 5px; }
    .profile-email a { color: #00d9ff; text-decoration: none; }
    .profile-email a:hover { text-decoration: underline; }
    .qr-area { display: flex; justify-content: center; }
    .qr-code { width: 130px; height: 130px; background: #fff; border-radius: 12px; display: flex; align-items: center; justify-content: center; padding: 8px; }
    .qr-code img { width: 100%; height: 100%; }
    .manual-text { font-size: 13px; line-height: 1.7; color: #ccc; }
    .manual-text h4 { color: #00d9ff; margin: 12px 0 6px 0; font-size: 14px; }
    .manual-text ul { margin-left: 18px; }
    .version-info { text-align: center; padding: 15px 0 5px 0; font-size: 11px; color: #666; letter-spacing: 2px; border-top: 1px solid rgba(255,255,255,0.1); margin-top: 20px; }
    .config-empty { text-align: center; padding: 40px 20px; color: #666; }
    .config-empty.hidden { display: none; }
    .config-empty-icon { font-size: 40px; margin-bottom: 15px; opacity: 0.5; }
    .config-empty-text { font-size: 14px; line-height: 1.6; }
    .config-content.hidden { display: none; }
  </style>
</head>
<body>
  <div class="container" id="app">
    <div class="header-bar">
      <div class="header-title" id="logoArea"><span class="missjo">MISSJO</span> <span class="from">from MARINEBOY</span></div>
      <div class="header-buttons">
        <button class="lang-btn active" id="langKo" onclick="setLanguage('ko')">ğŸŒ KO</button>
        <button class="lang-btn" id="langEn" onclick="setLanguage('en')">ğŸŒ EN</button>
        <button class="info-btn" onclick="openModal()">â„¹ï¸ Info</button>
      </div>
    </div>
    
    <div class="modal-overlay" id="modalOverlay" onclick="closeModalOutside(event)">
      <div class="modal">
        <div class="modal-header">
          <span class="modal-title" id="modalTitle">ì •ë³´ ë° ì‚¬ìš©ë²•</span>
          <button class="modal-close" onclick="closeModal()">&times;</button>
        </div>
        <div class="modal-body">
          <div class="info-section">
            <div class="info-section-title" id="developerLabel">ê°œë°œì</div>
            <div class="profile-area">
              <div class="profile-photo"><img src="data:image/jpeg;base64,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" alt="MBOY"></div>
              <div><div class="profile-name">MarineBOY</div><div class="profile-desc">Circus Artist & Art Technician</div><div class="profile-email"><a href="mailto:marineboycircus@gmail.com">marineboycircus@gmail.com</a></div></div>
            </div>
          </div>
          <div class="info-section">
            <div class="info-section-title" id="qrLabel">QR ì½”ë“œ</div>
            <div class="qr-area"><div class="qr-code"><a href="https://instagram.com/marineboy" target="_blank"><img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://instagram.com/marineboy" alt="QR Code"></a></div></div>
          </div>
          <div class="info-section">
            <div class="info-section-title" id="manualLabel">ì‚¬ìš©ë²•</div>
            <div class="manual-text" id="manualContent">
              <h4>1. ì—°ê²°</h4><ul><li>USB ì—°ê²° í›„ "ì—°ê²°" í´ë¦­</li></ul>
              <h4>2. í”„ë¦¬ì…‹</h4><ul><li>í”„ë¦¬ì…‹ ì„ íƒ â†’ ë¶ˆëŸ¬ì˜¤ê¸°</li></ul>
              <h4>3. ë²„íŠ¼ ì„¤ì •</h4><ul><li>ë²„íŠ¼ í´ë¦­ â†’ ì„¤ì • ë³€ê²½ â†’ ì €ì¥</li></ul>
            </div>
          </div>
          <div class="version-info">V1.0</div>
        </div>
      </div>
    </div>
    
    <div class="card">
      <div class="status-bar">
        <div class="status">
          <div class="status-dot" id="statusDot"></div>
          <span id="statusText">ì—°ê²° ì•ˆë¨</span>
          <span class="unsaved-badge hidden" id="unsavedBadge">ì €ì¥ ì•ˆë¨</span>
        </div>
        <button class="btn btn-connect" id="connectBtn" onclick="toggleConnection()">ì—°ê²°</button>
      </div>
      <div class="btn-row">
        <button class="btn btn-load-device" id="loadDeviceBtn" onclick="loadFromDevice()" disabled><span id="loadDeviceBtnText">ğŸ“¥ ì¥ì¹˜ì—ì„œ ë¶ˆëŸ¬ì˜¤ê¸°</span></button>
        <button class="btn btn-save" id="saveBtn" onclick="saveToDevice()" disabled><span id="saveBtnText">ğŸ’¾ ì¥ì¹˜ì— ì €ì¥</span></button>
      </div>
    </div>
    
    <div class="card hidden" id="presetCard">
      <div class="card-title"><span id="presetsLabel">í”„ë¦¬ì…‹</span></div>
      <div class="preset-grid" id="presetGrid"></div>
      <div class="preset-actions">
        <button class="btn btn-load" onclick="loadPreset()" id="loadBtn">ğŸ“¥ ë¶ˆëŸ¬ì˜¤ê¸°</button>
      </div>
    </div>
    
    <div class="card hidden" id="buttonStatusCard">
      <div class="card-title">
        <span id="buttonStatusLabel">ë²„íŠ¼ ìƒíƒœ</span>
        <span class="virtual-hint hidden" id="virtualHint">âœ¨ ì‹¤ì œ ë²„íŠ¼ì²˜ëŸ¼ ì‘ë™ë©ë‹ˆë‹¤! ëˆŒëŸ¬ë³´ì„¸ìš”!</span>
        <div class="virtual-toggle">
          <span id="virtualBtnLabel">ê°€ìƒë²„íŠ¼</span>
          <label class="toggle"><input type="checkbox" id="virtualEnabled" onchange="onVirtualToggle()"><span class="toggle-slider"></span></label>
        </div>
      </div>
      <div class="button-grid" id="buttonGrid"></div>
    </div>
    
    <div class="card hidden" id="configCard">
      <div class="card-title"><span id="configTitle">ë²„íŠ¼ ì„¤ì • - <span id="selectedBtnLabel">BTN 1</span></span></div>
      <div class="config-empty" id="configEmpty">
        <div class="config-empty-icon">ğŸ“‹</div>
        <div class="config-empty-text" id="configEmptyText">í”„ë¦¬ì…‹ì„ ì„ íƒí•˜ê±°ë‚˜<br>ì¥ì¹˜ì—ì„œ ë¶ˆëŸ¬ì˜¤ê¸°ë¥¼ í•´ì£¼ì„¸ìš”</div>
      </div>
      <div class="config-content" id="configContent">
      <div class="mode-select">
        <button class="mode-btn active" id="modeSingle" onclick="setMode(0)">ğŸ”˜ <span class="mode-text">ì‹±ê¸€</span></button>
        <button class="mode-btn" id="modeDouble" onclick="setMode(1)">ğŸ”˜ğŸ”˜ <span class="mode-text">ë”ë¸”</span></button>
      </div>
      <div class="action-card">
        <div class="action-header">
          <span class="action-title short">âš¡ Short Press</span>
          <label class="toggle"><input type="checkbox" id="shortEnabled" checked onchange="updateAction('short')"><span class="toggle-slider"></span></label>
        </div>
        <div id="shortSettings">
          <div class="form-group">
            <label class="form-label" id="shortTypeLabel">íƒ€ì…</label>
            <select id="shortType" onchange="onTypeChange('short')">
              <option value="0">âŒ¨ï¸ í‚¤ë³´ë“œ</option><option value="1">ğŸµ ë¯¸ë””ì–´í‚¤</option>
              <option value="2">ğŸ¹ MIDI Note</option><option value="3">ğŸšï¸ MIDI CC</option>
              <option value="4">ğŸ“‹ MIDI PC</option><option value="5">ğŸ“ ë§¤í¬ë¡œ</option>
            </select>
          </div>
          <div id="shortParams"></div>
        </div>
      </div>
      <div class="slider-group hidden" id="longPressGroup">
        <div class="slider-box">
          <div class="slider-header">
            <div class="slider-title">
              <span class="icon">â±ï¸</span>
              <span id="longPressLabel">ë¡±í”„ë ˆìŠ¤ ì‹œê°„</span>
            </div>
            <div class="slider-value-box">
              <span class="slider-value" id="lpTimeValue">1.0 sec</span>
            </div>
          </div>
          <input type="range" id="lpTimeSlider" min="500" max="3000" step="100" value="1000" oninput="updateLongPressTime()">
        </div>
      </div>
      <div class="action-card hidden" id="longActionCard">
        <div class="action-header">
          <span class="action-title long">â³ Long Press</span>
          <label class="toggle"><input type="checkbox" id="longEnabled" checked onchange="updateAction('long')"><span class="toggle-slider"></span></label>
        </div>
        <div id="longSettings">
          <div class="form-group">
            <label class="form-label" id="longTypeLabel">íƒ€ì…</label>
            <select id="longType" onchange="onTypeChange('long')">
              <option value="0">âŒ¨ï¸ í‚¤ë³´ë“œ</option><option value="1">ğŸµ ë¯¸ë””ì–´í‚¤</option>
              <option value="2">ğŸ¹ MIDI Note</option><option value="3">ğŸšï¸ MIDI CC</option>
              <option value="4">ğŸ“‹ MIDI PC</option><option value="5">ğŸ“ ë§¤í¬ë¡œ</option>
            </select>
          </div>
          <div id="longParams"></div>
        </div>
      </div>
      </div>
    </div>
    
    <div class="card hidden" id="logCard">
      <div class="card-title"><span id="logLabel">ë¡œê·¸</span></div>
      <div class="log" id="log"></div>
    </div>
  </div>

<script>
const i18n = {
  ko: { 
    disconnected:'ì—°ê²° ì•ˆë¨', connected:'ì—°ê²°ë¨', unsaved:'ì €ì¥ ì•ˆë¨', connect:'ì—°ê²°', disconnect:'ì—°ê²° í•´ì œ',
    presets:'í”„ë¦¬ì…‹', buttonStatus:'ë²„íŠ¼ ìƒíƒœ', virtualButton:'ê°€ìƒë²„íŠ¼', single:'ì‹±ê¸€', double:'ë”ë¸”',
    short:'S', long:'L', savedToEeprom:'âœ… EEPROMì— ì €ì¥ë¨', connectionFailed:'ì—°ê²° ì‹¤íŒ¨: ',
    key:'í‚¤', mediaKeyLabel:'ë¯¸ë””ì–´ í‚¤', note:'ë…¸íŠ¸', velocity:'ë²¨ë¡œì‹œí‹°', channel:'ì±„ë„',
    ccNumber:'CC #', value:'ê°’', programNumber:'í”„ë¡œê·¸ë¨ #', step:'ìŠ¤í…', delay:'ë”œë ˆì´',
    catAlphabet:'ğŸ”¤ ì•ŒíŒŒë²³', catNumber:'ğŸ”¢ ìˆ«ì', catFkeys:'ğŸ¯ Fí‚¤', catNavigation:'ğŸ§­ ë„¤ë¹„ê²Œì´ì…˜',
    catSpecial:'âš™ï¸ íŠ¹ìˆ˜í‚¤', catPunctuation:'âœï¸ êµ¬ë‘ì ', catSymbols:'ğŸ”£ íŠ¹ìˆ˜ë¬¸ì',
    // ì¶”ê°€ëœ ë²ˆì—­
    saveToDevice:'ğŸ’¾ ì¥ì¹˜ì— ì €ì¥', loadFromDevice:'ğŸ“¥ ì¥ì¹˜ì—ì„œ ë¶ˆëŸ¬ì˜¤ê¸°', loadPreset:'ğŸ“¥ ë¶ˆëŸ¬ì˜¤ê¸°', buttonConfig:'ë²„íŠ¼ ì„¤ì •',
    longPressTime:'ë¡±í”„ë ˆìŠ¤ ì‹œê°„', type:'íƒ€ì…', log:'ë¡œê·¸',
    keyboard:'âŒ¨ï¸ í‚¤ë³´ë“œ', mediaKey:'ğŸµ ë¯¸ë””ì–´í‚¤', midiNote:'ğŸ¹ MIDI Note', 
    midiCC:'ğŸšï¸ MIDI CC', midiPC:'ğŸ“‹ MIDI PC', macro:'ğŸ“ ë§¤í¬ë¡œ',
    modalTitle:'ì •ë³´ ë° ì‚¬ìš©ë²•', developer:'ê°œë°œì', profileDesc:'ì„ë² ë””ë“œ ì‹œìŠ¤í…œ ê°œë°œì',
    qrCode:'QR ì½”ë“œ', manual:'ì‚¬ìš©ë²•', photoPlaceholder:'ì‚¬ì§„<br>ì¤€ë¹„ì¤‘', qrPlaceholder:'QRì½”ë“œ<br>ì¤€ë¹„ì¤‘',
    manualContent:'<h4>1. ì—°ê²°</h4><ul><li>USB ì—°ê²° í›„ "ì—°ê²°" í´ë¦­</li></ul><h4>2. í”„ë¦¬ì…‹</h4><ul><li>í”„ë¦¬ì…‹ ì„ íƒ â†’ ë¶ˆëŸ¬ì˜¤ê¸°</li></ul><h4>3. ë²„íŠ¼ ì„¤ì •</h4><ul><li>ë²„íŠ¼ í´ë¦­ â†’ ì„¤ì • ë³€ê²½ â†’ ì €ì¥</li></ul>',
    loaded:'ë¶ˆëŸ¬ì˜´', configLoaded:'ì„¤ì • ë¶ˆëŸ¬ì˜¤ê¸° ì™„ë£Œ',
    virtualHint:'âœ¨ ì‹¤ì œ ë²„íŠ¼ì²˜ëŸ¼ ì‘ë™ë©ë‹ˆë‹¤! ëˆŒëŸ¬ë³´ì„¸ìš”!',
    configEmptyText:'í”„ë¦¬ì…‹ì„ ì„ íƒí•˜ê±°ë‚˜<br>ì¥ì¹˜ì—ì„œ ë¶ˆëŸ¬ì˜¤ê¸°ë¥¼ í•´ì£¼ì„¸ìš”'
  },
  en: { 
    disconnected:'Disconnected', connected:'Connected', unsaved:'Unsaved', connect:'Connect', disconnect:'Disconnect',
    presets:'Presets', buttonStatus:'Button Status', virtualButton:'Virtual Btn', single:'Single', double:'Double',
    short:'S', long:'L', savedToEeprom:'âœ… Saved to EEPROM', connectionFailed:'Connection failed: ',
    key:'Key', mediaKeyLabel:'Media Key', note:'Note', velocity:'Velocity', channel:'Channel',
    ccNumber:'CC #', value:'Value', programNumber:'Program #', step:'Step', delay:'Delay',
    catAlphabet:'ğŸ”¤ Alphabet', catNumber:'ğŸ”¢ Numbers', catFkeys:'ğŸ¯ F-Keys', catNavigation:'ğŸ§­ Navigation',
    catSpecial:'âš™ï¸ Special', catPunctuation:'âœï¸ Punctuation', catSymbols:'ğŸ”£ Symbols',
    // ì¶”ê°€ëœ ë²ˆì—­
    saveToDevice:'ğŸ’¾ Save to Device', loadFromDevice:'ğŸ“¥ Load from Device', loadPreset:'ğŸ“¥ Load', buttonConfig:'Button Config',
    longPressTime:'Long Press Time', type:'Type', log:'Log',
    keyboard:'âŒ¨ï¸ Keyboard', mediaKey:'ğŸµ Media Key', midiNote:'ğŸ¹ MIDI Note', 
    midiCC:'ğŸšï¸ MIDI CC', midiPC:'ğŸ“‹ MIDI PC', macro:'ğŸ“ Macro',
    modalTitle:'Info & Manual', developer:'Developer', profileDesc:'Embedded Systems Developer',
    qrCode:'QR Code', manual:'Manual', photoPlaceholder:'Photo<br>Coming Soon', qrPlaceholder:'QR Code<br>Coming Soon',
    manualContent:'<h4>1. Connect</h4><ul><li>Connect USB, then click "Connect"</li></ul><h4>2. Presets</h4><ul><li>Select preset â†’ Load</li></ul><h4>3. Button Config</h4><ul><li>Click button â†’ Change settings â†’ Save</li></ul>',
    loaded:'loaded', configLoaded:'Config loaded',
    virtualHint:'âœ¨ Works like real buttons! Try clicking!',
    configEmptyText:'Select a preset or<br>load from device'
  }
};
let currentLang = 'ko';

const keyCategories = {
  alphabet: { name: 'ğŸ”¤ ì•ŒíŒŒë²³', keys: [] },
  number: { name: 'ğŸ”¢ ìˆ«ì', keys: [] },
  fkeys: { name: 'ğŸ¯ Fí‚¤', keys: [{value:194,name:'F1'},{value:195,name:'F2'},{value:196,name:'F3'},{value:197,name:'F4'},{value:198,name:'F5'},{value:199,name:'F6'},{value:200,name:'F7'},{value:201,name:'F8'},{value:202,name:'F9'},{value:203,name:'F10'},{value:204,name:'F11'},{value:205,name:'F12'}] },
  navigation: { name: 'ğŸ§­ ë„¤ë¹„ê²Œì´ì…˜', keys: [{value:218,name:'â†‘'},{value:217,name:'â†“'},{value:216,name:'â†'},{value:215,name:'â†’'},{value:210,name:'Home'},{value:213,name:'End'},{value:211,name:'PgUp'},{value:214,name:'PgDn'}] },
  special: { name: 'âš™ï¸ íŠ¹ìˆ˜í‚¤', keys: [{value:32,name:'Space'},{value:176,name:'Enter'},{value:179,name:'Tab'},{value:177,name:'Backspace'},{value:178,name:'Esc'}] },
  punctuation: { name: 'âœï¸ êµ¬ë‘ì ', keys: [{value:45,name:'-'},{value:61,name:'='},{value:91,name:'['},{value:93,name:']'},{value:92,name:'\\'},{value:59,name:';'},{value:39,name:"'"},{value:44,name:','},{value:46,name:'.'},{value:47,name:'/'}] },
  symbols: { name: 'ğŸ”£ íŠ¹ìˆ˜ë¬¸ì', keys: [{value:33,name:'!'},{value:64,name:'@'},{value:35,name:'#'},{value:36,name:'$'},{value:37,name:'%'},{value:94,name:'^'},{value:38,name:'&'},{value:42,name:'*'},{value:40,name:'('},{value:41,name:')'}] }
};
for(let i=0;i<26;i++) keyCategories.alphabet.keys.push({value:97+i,name:String.fromCharCode(65+i)});
for(let i=0;i<=9;i++) keyCategories.number.keys.push({value:48+i,name:String(i)});

const mediaKeys = [{value:0,name:'â¯ï¸ Play/Pause'},{value:1,name:'â¹ï¸ Stop'},{value:2,name:'â®ï¸ Prev'},{value:3,name:'â­ï¸ Next'},{value:4,name:'ğŸ”Š Vol+'},{value:5,name:'ğŸ”‰ Vol-'},{value:6,name:'ğŸ”‡ Mute'}];

const presets = [
  { icon:'ğŸ”Š', name:'MUSIC_1KEY', buttons:[{m:0,lp:1000,sE:1,sT:1,sV1:0,sV2:0,lE:0,lT:1,lV1:0,lV2:0},{m:0,lp:1000,sE:1,sT:1,sV1:2,sV2:0,lE:0,lT:1,lV1:0,lV2:0},{m:0,lp:1000,sE:1,sT:1,sV1:3,sV2:0,lE:0,lT:1,lV1:0,lV2:0},{m:0,lp:1000,sE:1,sT:1,sV1:5,sV2:0,lE:0,lT:1,lV1:0,lV2:0},{m:0,lp:1000,sE:1,sT:1,sV1:4,sV2:0,lE:0,lT:1,lV1:0,lV2:0},{m:0,lp:1000,sE:1,sT:1,sV1:6,sV2:0,lE:0,lT:1,lV1:0,lV2:0}] },
  { icon:'ğŸ¶', name:'MUSIC+MIDI', buttons:[{m:1,lp:1000,sE:1,sT:1,sV1:0,sV2:0,lE:1,lT:2,lV1:61,lV2:127},{m:1,lp:1000,sE:1,sT:1,sV1:2,sV2:0,lE:1,lT:2,lV1:62,lV2:127},{m:1,lp:1000,sE:1,sT:1,sV1:3,sV2:0,lE:1,lT:2,lV1:63,lV2:127},{m:1,lp:1000,sE:1,sT:1,sV1:5,sV2:0,lE:1,lT:2,lV1:64,lV2:127},{m:1,lp:1000,sE:1,sT:1,sV1:4,sV2:0,lE:1,lT:2,lV1:65,lV2:127},{m:1,lp:1000,sE:1,sT:1,sV1:6,sV2:0,lE:1,lT:2,lV1:66,lV2:127}] },
  { icon:'ğŸ¹', name:'MIDI_1KEY', buttons:[{m:0,lp:1000,sE:1,sT:2,sV1:61,sV2:127,lE:0,lT:2,lV1:0,lV2:0},{m:0,lp:1000,sE:1,sT:2,sV1:62,sV2:127,lE:0,lT:2,lV1:0,lV2:0},{m:0,lp:1000,sE:1,sT:2,sV1:63,sV2:127,lE:0,lT:2,lV1:0,lV2:0},{m:0,lp:1000,sE:1,sT:2,sV1:64,sV2:127,lE:0,lT:2,lV1:0,lV2:0},{m:0,lp:1000,sE:1,sT:2,sV1:65,sV2:127,lE:0,lT:2,lV1:0,lV2:0},{m:0,lp:1000,sE:1,sT:2,sV1:66,sV2:127,lE:0,lT:2,lV1:0,lV2:0}] },
  { icon:'ğŸ¥', name:'MIDI_2KEY', buttons:[{m:1,lp:1000,sE:1,sT:2,sV1:61,sV2:127,lE:1,lT:2,lV1:71,lV2:127},{m:1,lp:1000,sE:1,sT:2,sV1:62,sV2:127,lE:1,lT:2,lV1:72,lV2:127},{m:1,lp:1000,sE:1,sT:2,sV1:63,sV2:127,lE:1,lT:2,lV1:73,lV2:127},{m:1,lp:1000,sE:1,sT:2,sV1:64,sV2:127,lE:1,lT:2,lV1:74,lV2:127},{m:1,lp:1000,sE:1,sT:2,sV1:65,sV2:127,lE:1,lT:2,lV1:75,lV2:127},{m:1,lp:1000,sE:1,sT:2,sV1:66,sV2:127,lE:1,lT:2,lV1:76,lV2:127}] },
  { icon:'ğŸ¯', name:'GoButton', buttons:[{m:1,lp:1000,sE:1,sT:2,sV1:61,sV2:127,lE:1,lT:2,lV1:71,lV2:127},{m:1,lp:1000,sE:1,sT:2,sV1:62,sV2:127,lE:1,lT:2,lV1:72,lV2:127},{m:1,lp:1000,sE:1,sT:2,sV1:63,sV2:127,lE:1,lT:2,lV1:73,lV2:127},{m:1,lp:1000,sE:1,sT:2,sV1:64,sV2:127,lE:1,lT:2,lV1:74,lV2:127},{m:1,lp:1000,sE:1,sT:2,sV1:65,sV2:127,lE:1,lT:2,lV1:75,lV2:127},{m:1,lp:1000,sE:1,sT:2,sV1:66,sV2:127,lE:1,lT:2,lV1:76,lV2:127}] },
  { icon:'ğŸ¬', name:'QLAB', buttons:[{m:1,lp:1000,sE:1,sT:0,sV1:32,sV2:0,lE:1,lT:2,lV1:71,lV2:127},{m:1,lp:1000,sE:1,sT:0,sV1:108,sV2:0,lE:1,lT:2,lV1:72,lV2:127},{m:1,lp:1000,sE:1,sT:0,sV1:115,sV2:0,lE:1,lT:2,lV1:73,lV2:127},{m:1,lp:1000,sE:1,sT:0,sV1:112,sV2:0,lE:1,lT:2,lV1:74,lV2:127},{m:1,lp:1000,sE:1,sT:0,sV1:91,sV2:0,lE:1,lT:2,lV1:75,lV2:127},{m:1,lp:1000,sE:1,sT:0,sV1:93,sV2:0,lE:1,lT:2,lV1:76,lV2:127}] },
  { icon:'ğŸ–¥ï¸', name:'PPT', buttons:[{m:0,lp:1000,sE:1,sT:0,sV1:215,sV2:0,lE:0,lT:0,lV1:0,lV2:0},{m:0,lp:1000,sE:1,sT:0,sV1:216,sV2:0,lE:0,lT:0,lV1:0,lV2:0},{m:0,lp:1000,sE:1,sT:0,sV1:198,sV2:0,lE:0,lT:0,lV1:0,lV2:0},{m:0,lp:1000,sE:1,sT:0,sV1:178,sV2:0,lE:0,lT:0,lV1:0,lV2:0},{m:0,lp:1000,sE:1,sT:0,sV1:98,sV2:0,lE:0,lT:0,lV1:0,lV2:0},{m:0,lp:1000,sE:1,sT:0,sV1:119,sV2:0,lE:0,lT:0,lV1:0,lV2:0}] },
  { icon:'ğŸ”¢', name:'Number', buttons:[{m:1,lp:1000,sE:1,sT:0,sV1:49,sV2:0,lE:1,lT:0,lV1:55,lV2:0},{m:1,lp:1000,sE:1,sT:0,sV1:50,sV2:0,lE:1,lT:0,lV1:56,lV2:0},{m:1,lp:1000,sE:1,sT:0,sV1:51,sV2:0,lE:1,lT:0,lV1:57,lV2:0},{m:1,lp:1000,sE:1,sT:0,sV1:52,sV2:0,lE:1,lT:0,lV1:48,lV2:0},{m:1,lp:1000,sE:1,sT:0,sV1:53,sV2:0,lE:1,lT:0,lV1:46,lV2:0},{m:1,lp:1000,sE:1,sT:0,sV1:54,sV2:0,lE:1,lT:0,lV1:44,lV2:0}] },
  { icon:'ğŸ‘ğŸ¼', name:'CustomKEY', buttons:[{m:1,lp:1000,sE:1,sT:0,sV1:97,sV2:0,lE:1,lT:0,lV1:103,lV2:0},{m:1,lp:1000,sE:1,sT:0,sV1:98,sV2:0,lE:1,lT:0,lV1:104,lV2:0},{m:1,lp:1000,sE:1,sT:0,sV1:99,sV2:0,lE:1,lT:0,lV1:105,lV2:0},{m:1,lp:1000,sE:1,sT:0,sV1:100,sV2:0,lE:1,lT:0,lV1:106,lV2:0},{m:1,lp:1000,sE:1,sT:0,sV1:101,sV2:0,lE:1,lT:0,lV1:107,lV2:0},{m:1,lp:1000,sE:1,sT:0,sV1:102,sV2:0,lE:1,lT:0,lV1:108,lV2:0}] },
  { icon:'ğŸ‘¶ğŸ»', name:'CustomMIDI', buttons:[{m:1,lp:1000,sE:1,sT:2,sV1:41,sV2:127,lE:1,lT:2,lV1:51,lV2:127},{m:1,lp:1000,sE:1,sT:2,sV1:42,sV2:127,lE:1,lT:2,lV1:52,lV2:127},{m:1,lp:1000,sE:1,sT:2,sV1:43,sV2:127,lE:1,lT:2,lV1:53,lV2:127},{m:1,lp:1000,sE:1,sT:2,sV1:44,sV2:127,lE:1,lT:2,lV1:54,lV2:127},{m:1,lp:1000,sE:1,sT:2,sV1:45,sV2:127,lE:1,lT:2,lV1:55,lV2:127},{m:1,lp:1000,sE:1,sT:2,sV1:46,sV2:127,lE:1,lT:2,lV1:56,lV2:127}] }
];

let port=null, reader=null, writer=null, sendTimeout=null;
let selectedPreset=-1, selectedBtn=0, virtualTimer=null, dataLoaded=false;

let buttons = [];
for(let i=0;i<6;i++){
  buttons.push({ mode:0, longPressTime:1000, shortEnabled:1, shortType:1, shortValue1:0, shortValue2:0, shortChannel:1,
    shortMacro:[{delay:1000,type:0,value1:0,value2:0,value3:1},{delay:1000,type:0,value1:0,value2:0,value3:1},{delay:1000,type:0,value1:0,value2:0,value3:1}],
    longEnabled:1, longType:1, longValue1:0, longValue2:0, longChannel:1,
    longMacro:[{delay:1000,type:0,value1:0,value2:0,value3:1},{delay:1000,type:0,value1:0,value2:0,value3:1},{delay:1000,type:0,value1:0,value2:0,value3:1}] });
}

function init(){
  if(!('serial' in navigator)){ document.getElementById('app').innerHTML='<div class="card" style="text-align:center;padding:50px;"><h2 style="color:#ff4757">âš ï¸ Web Serial Not Supported</h2><p>Please use Chrome/Edge.</p></div>'; return; }
  const lang = localStorage.getItem('proMicroLang')||'ko'; setLanguage(lang);
  renderPresets(); renderButtonGrid(); selectButton(0);
  updateConfigCardState();
  initDevMode();
}

function updateConfigCardState(){
  const t=i18n[currentLang];
  document.getElementById('configEmpty').classList.toggle('hidden', dataLoaded);
  document.getElementById('configContent').classList.toggle('hidden', !dataLoaded);
  document.getElementById('configEmptyText').innerHTML = t.configEmptyText;
}

let _m = false;
let _t = null;

function initDevMode() {
  const el = document.getElementById('logoArea');
  el.addEventListener('mousedown', _s);
  el.addEventListener('mouseup', _c);
  el.addEventListener('mouseleave', _c);
  el.addEventListener('touchstart', _s);
  el.addEventListener('touchend', _c);
}

function _s(e) {
  e.preventDefault();
  _t = setTimeout(() => {
    _m = !_m;
    document.getElementById('logCard').classList.toggle('hidden', !_m);
  }, 7000);
}

function _c() {
  if(_t) {
    clearTimeout(_t);
    _t = null;
  }
}

function setLanguage(lang){
  currentLang=lang;
  const t = i18n[lang];
  
  // ì–¸ì–´ ë²„íŠ¼ í™œì„±í™” ìƒíƒœ
  document.getElementById('langKo').classList.toggle('active',lang==='ko');
  document.getElementById('langEn').classList.toggle('active',lang==='en');
  
  // ì¹´í…Œê³ ë¦¬ ì´ë¦„ ì—…ë°ì´íŠ¸
  keyCategories.alphabet.name=t.catAlphabet; 
  keyCategories.number.name=t.catNumber;
  keyCategories.fkeys.name=t.catFkeys; 
  keyCategories.navigation.name=t.catNavigation;
  keyCategories.special.name=t.catSpecial; 
  keyCategories.punctuation.name=t.catPunctuation;
  keyCategories.symbols.name=t.catSymbols;
  
  // ìƒíƒœ í‘œì‹œ
  document.getElementById('statusText').textContent = port ? t.connected : t.disconnected;
  document.getElementById('unsavedBadge').textContent = t.unsaved;
  document.getElementById('connectBtn').textContent = port ? t.disconnect : t.connect;
  
  // ë©”ì¸ UI í…ìŠ¤íŠ¸
  document.getElementById('loadDeviceBtnText').textContent = t.loadFromDevice;
  document.getElementById('saveBtnText').textContent = t.saveToDevice;
  document.getElementById('presetsLabel').textContent = t.presets;
  document.getElementById('loadBtn').textContent = t.loadPreset;
  document.getElementById('buttonStatusLabel').textContent = t.buttonStatus;
  document.getElementById('virtualBtnLabel').textContent = t.virtualButton;
  document.getElementById('virtualHint').textContent = t.virtualHint;
  document.getElementById('configTitle').innerHTML = t.buttonConfig + ' - <span id="selectedBtnLabel">BTN ' + (selectedBtn+1) + '</span>';
  document.getElementById('longPressLabel').textContent = t.longPressTime;
  document.getElementById('logLabel').textContent = t.log;
  
  // ëª¨ë“œ ë²„íŠ¼
  document.querySelectorAll('.mode-text').forEach((el, idx) => {
    el.textContent = idx === 0 ? t.single : t.double;
  });
  
  // íƒ€ì… ë¼ë²¨
  document.getElementById('shortTypeLabel').textContent = t.type;
  document.getElementById('longTypeLabel').textContent = t.type;
  
  // íƒ€ì… select ì˜µì…˜
  updateTypeOptions('shortType');
  updateTypeOptions('longType');
  
  // ëª¨ë‹¬
  document.getElementById('modalTitle').textContent = t.modalTitle;
  document.getElementById('developerLabel').textContent = t.developer;
  document.getElementById('qrLabel').textContent = t.qrCode;
  document.getElementById('manualLabel').textContent = t.manual;
  document.getElementById('manualContent').innerHTML = t.manualContent;
  
  localStorage.setItem('proMicroLang',lang);
  updateConfigCardState();
  renderButtonGrid(); 
  if(dataLoaded) { renderParams('short'); renderParams('long'); }
}

function updateTypeOptions(selectId) {
  const t = i18n[currentLang];
  const select = document.getElementById(selectId);
  if (!select) return;
  const currentValue = select.value;
  select.innerHTML = `
    <option value="0">${t.keyboard}</option>
    <option value="1">${t.mediaKey}</option>
    <option value="2">${t.midiNote}</option>
    <option value="3">${t.midiCC}</option>
    <option value="4">${t.midiPC}</option>
    <option value="5">${t.macro}</option>
  `;
  select.value = currentValue;
}

function openModal(){ document.getElementById('modalOverlay').classList.add('show'); }
function closeModal(){ document.getElementById('modalOverlay').classList.remove('show'); }
function closeModalOutside(e){ if(e.target.id==='modalOverlay')closeModal(); }

function renderPresets(){
  document.getElementById('presetGrid').innerHTML = presets.map((p,i)=>`<div class="preset-box ${i===selectedPreset?'selected':''}" onclick="selectPreset(${i})"><div class="preset-icon">${p.icon}</div><div class="preset-name">${p.name}</div></div>`).join('');
}
function selectPreset(i){ selectedPreset=i; renderPresets(); }
function loadPreset(){
  if(selectedPreset<0) return;
  const p=presets[selectedPreset];
  const t=i18n[currentLang];
  const defaultMacro=[{delay:1000,type:0,value1:0,value2:0,value3:1},{delay:1000,type:0,value1:0,value2:0,value3:1},{delay:1000,type:0,value1:0,value2:0,value3:1}];
  for(let i=0;i<6;i++){ 
    const b=p.buttons[i]; 
    buttons[i].mode=b.m; 
    buttons[i].longPressTime=b.lp; 
    buttons[i].shortEnabled=b.sE; 
    buttons[i].shortType=b.sT; 
    buttons[i].shortValue1=b.sV1; 
    buttons[i].shortValue2=b.sV2; 
    buttons[i].shortChannel=b.sCh||1;
    buttons[i].longEnabled=b.lE; 
    buttons[i].longType=b.lT; 
    buttons[i].longValue1=b.lV1; 
    buttons[i].longValue2=b.lV2;
    buttons[i].longChannel=b.lCh||1;
    buttons[i].shortMacro=b.sM?JSON.parse(JSON.stringify(b.sM)):JSON.parse(JSON.stringify(defaultMacro));
    buttons[i].longMacro=b.lM?JSON.parse(JSON.stringify(b.lM)):JSON.parse(JSON.stringify(defaultMacro));
  }
  dataLoaded=true;
  updateConfigCardState();
  renderButtonGrid(); selectButton(selectedBtn); setUnsaved(true); log('ğŸ“¥ '+p.name+' '+t.loaded,'info');
}

function renderButtonGrid(){
  const t=i18n[currentLang];
  if(!dataLoaded){
    document.getElementById('buttonGrid').innerHTML = buttons.map((b,i)=>`
      <div class="button-box ${i===selectedBtn?'selected':''}" id="btnBox${i}" onclick="selectButton(${i})">
        <div class="button-box-header"><span class="button-number">BTN ${i+1}</span><span class="button-mode-badge single">â€”</span></div>
        <div class="button-info"><div class="button-info-row"><span class="button-info-value" style="color:#666">â€”</span></div></div>
      </div>`).join('');
    return;
  }
  document.getElementById('buttonGrid').innerHTML = buttons.map((b,i)=>`
    <div class="button-box ${i===selectedBtn?'selected':''}" id="btnBox${i}" onclick="selectButton(${i})" onmousedown="virtualDown(${i})" onmouseup="virtualUp(${i})" onmouseleave="virtualUp(${i})">
      <div class="button-box-header"><span class="button-number">BTN ${i+1}</span><span class="button-mode-badge ${b.mode===0?'single':'double'}">${b.mode===0?t.single:t.double}</span></div>
      <div class="button-info">
        <div class="button-info-row"><span class="button-info-label">${t.short}:</span><span class="button-info-value">${getActionLabel(b,'short')}</span></div>
        ${b.mode===1?`<div class="button-info-row"><span class="button-info-label">${t.long}:</span><span class="button-info-value">${getActionLabel(b,'long')}</span></div>`:''}
      </div>
    </div>`).join('');
}

function getActionLabel(b,type){
  const t=i18n[currentLang];
  const en=type==='short'?b.shortEnabled:b.longEnabled;
  const actionType=type==='short'?b.shortType:b.longType;
  const v1=type==='short'?b.shortValue1:b.longValue1;
  const v2=type==='short'?b.shortValue2:b.longValue2;
  const ch=type==='short'?b.shortChannel:b.longChannel;
  if(!en)return'â€”';
  
  // í‚¤ë³´ë“œ
  if(actionType===0){
    let mods = '';
    if(v2 & 1) mods += 'Ctrl+';
    if(v2 & 2) mods += 'Alt+';
    if(v2 & 4) mods += 'Shift+';
    if(v2 & 8) mods += 'Win+';
    return mods + getKeyName(v1);
  }
  // ë¯¸ë””ì–´í‚¤ - ì „ì²´ ì´ë¦„ í‘œì‹œ
  if(actionType===1) return mediaKeys[v1]?.name || '?';
  // MIDI Note - ë…¸íŠ¸, ë²¨ë¡œì‹œí‹°, ì±„ë„
  if(actionType===2) return 'Note:'+v1+' Vel:'+v2+' Ch:'+ch;
  // MIDI CC - CCë²ˆí˜¸, ê°’, ì±„ë„
  if(actionType===3) return 'CC:'+v1+' Val:'+v2+' Ch:'+ch;
  // MIDI PC - í”„ë¡œê·¸ë¨ë²ˆí˜¸, ì±„ë„
  if(actionType===4) return 'PC:'+v1+' Ch:'+ch;
  // ë§¤í¬ë¡œ
  if(actionType===5) return t.macro.replace('ğŸ“ ','');
  return'?';
}
function getKeyName(code){ for(const c of Object.values(keyCategories)){const k=c.keys.find(k=>k.value===code);if(k)return k.name;} return String.fromCharCode(code); }

function selectButton(i){ 
  selectedBtn=i; 
  const t=i18n[currentLang];
  document.getElementById('configTitle').innerHTML = t.buttonConfig + ' - <span id="selectedBtnLabel">BTN '+(i+1)+'</span>';
  renderButtonGrid(); 
  if(dataLoaded) updateConfigUI(); 
}

function onVirtualToggle(){
  const enabled = document.getElementById('virtualEnabled').checked;
  const hint = document.getElementById('virtualHint');
  const t = i18n[currentLang];
  hint.textContent = t.virtualHint;
  hint.classList.toggle('hidden', !enabled);
}

function virtualDown(i){
  if(!document.getElementById('virtualEnabled').checked)return;
  document.getElementById('btnBox'+i).classList.add('virtual-active');
  virtualTimer=setTimeout(()=>{ 
    if(buttons[i].mode===1) sendCommand('BTN:'+i+':L'); 
    virtualTimer=null;  // ë¡±í”„ë ˆìŠ¤ ì‹¤í–‰ í›„ íƒ€ì´ë¨¸ ì´ˆê¸°í™”
  },buttons[i].longPressTime);
}
function virtualUp(i){
  if(!document.getElementById('virtualEnabled').checked)return;
  document.getElementById('btnBox'+i)?.classList.remove('virtual-active');
  if(virtualTimer){clearTimeout(virtualTimer);sendCommand('BTN:'+i+':S');virtualTimer=null;}
}

function updateConfigUI(){
  const b=buttons[selectedBtn];
  const t=i18n[currentLang];
  document.getElementById('modeSingle').classList.toggle('active',b.mode===0);
  document.getElementById('modeDouble').classList.toggle('active',b.mode===1);
  document.getElementById('longPressGroup').classList.toggle('hidden',b.mode===0);
  document.getElementById('longActionCard').classList.toggle('hidden',b.mode===0);
  document.getElementById('lpTimeSlider').value=b.longPressTime;
  document.getElementById('lpTimeValue').textContent=(b.longPressTime/1000).toFixed(1)+' sec';
  document.getElementById('shortEnabled').checked=b.shortEnabled;
  document.getElementById('shortType').value=b.shortType;
  document.getElementById('shortSettings').classList.toggle('action-disabled',!b.shortEnabled);
  document.getElementById('longEnabled').checked=b.longEnabled;
  document.getElementById('longType').value=b.longType;
  document.getElementById('longSettings').classList.toggle('action-disabled',!b.longEnabled);
  renderParams('short'); renderParams('long');
}

function setMode(m){ buttons[selectedBtn].mode=m; updateConfigUI(); renderButtonGrid(); sendConfigDelayed(); }
function updateLongPressTime(){ buttons[selectedBtn].longPressTime=parseInt(document.getElementById('lpTimeSlider').value); document.getElementById('lpTimeValue').textContent=(buttons[selectedBtn].longPressTime/1000).toFixed(1)+' sec'; sendConfigDelayed(); }
function onTypeChange(prefix){ const b=buttons[selectedBtn]; const actionType=parseInt(document.getElementById(prefix+'Type').value); if(prefix==='short'){b.shortType=actionType;b.shortValue1=actionType===2?61:0;b.shortValue2=actionType===2?127:0;}else{b.longType=actionType;b.longValue1=actionType===2?61:0;b.longValue2=actionType===2?127:0;} renderParams(prefix); renderButtonGrid(); sendConfigDelayed(); }
function updateAction(prefix){ const b=buttons[selectedBtn]; const en=document.getElementById(prefix+'Enabled').checked?1:0; const actionType=parseInt(document.getElementById(prefix+'Type').value); const v1=document.getElementById(prefix+'Value1'); const v2=document.getElementById(prefix+'Value2'); const ch=document.getElementById(prefix+'Channel'); if(prefix==='short'){b.shortEnabled=en;b.shortType=actionType;if(v1)b.shortValue1=parseInt(v1.value)||0;if(v2)b.shortValue2=parseInt(v2.value)||0;if(ch)b.shortChannel=parseInt(ch.value)||1;document.getElementById('shortSettings').classList.toggle('action-disabled',!en);}else{b.longEnabled=en;b.longType=actionType;if(v1)b.longValue1=parseInt(v1.value)||0;if(v2)b.longValue2=parseInt(v2.value)||0;if(ch)b.longChannel=parseInt(ch.value)||1;document.getElementById('longSettings').classList.toggle('action-disabled',!en);} renderButtonGrid(); sendConfigDelayed(); }

function renderParams(prefix){
  const b=buttons[selectedBtn]; const t=i18n[currentLang]; const actionType=parseInt(document.getElementById(prefix+'Type').value);
  const v1=prefix==='short'?b.shortValue1:b.longValue1; const v2=prefix==='short'?b.shortValue2:b.longValue2; const ch=prefix==='short'?b.shortChannel:b.longChannel;
  const macro=prefix==='short'?b.shortMacro:b.longMacro; let html='';
  if(actionType===0){ let opts=''; for(const c of Object.values(keyCategories)){opts+=`<optgroup label="${c.name}">${c.keys.map(k=>`<option value="${k.value}" ${k.value===v1?'selected':''}>${k.name}</option>`).join('')}</optgroup>`;} html=`<div class="form-group"><label class="form-label">${t.key}</label><select id="${prefix}Value1" onchange="updateAction('${prefix}')">${opts}</select></div>`; }
  else if(actionType===1){ html=`<div class="form-group"><label class="form-label">${t.mediaKeyLabel}</label><select id="${prefix}Value1" onchange="updateAction('${prefix}')">${mediaKeys.map(k=>`<option value="${k.value}" ${k.value===v1?'selected':''}>${k.name}</option>`).join('')}</select></div>`; }
  else if(actionType===2){ html=`<div class="form-row-3"><div class="form-group"><label class="form-label">${t.note}</label><input type="number" id="${prefix}Value1" min="0" max="127" value="${v1}" oninput="updateAction('${prefix}')"></div><div class="form-group"><label class="form-label">${t.velocity}</label><input type="number" id="${prefix}Value2" min="0" max="127" value="${v2}" oninput="updateAction('${prefix}')"></div><div class="form-group"><label class="form-label">${t.channel}</label><input type="number" id="${prefix}Channel" min="1" max="16" value="${ch}" oninput="updateAction('${prefix}')"></div></div>`; }
  else if(actionType===3){ html=`<div class="form-row-3"><div class="form-group"><label class="form-label">${t.ccNumber}</label><input type="number" id="${prefix}Value1" min="0" max="127" value="${v1}" oninput="updateAction('${prefix}')"></div><div class="form-group"><label class="form-label">${t.value}</label><input type="number" id="${prefix}Value2" min="0" max="127" value="${v2}" oninput="updateAction('${prefix}')"></div><div class="form-group"><label class="form-label">${t.channel}</label><input type="number" id="${prefix}Channel" min="1" max="16" value="${ch}" oninput="updateAction('${prefix}')"></div></div>`; }
  else if(actionType===4){ html=`<div class="form-row"><div class="form-group"><label class="form-label">${t.programNumber}</label><input type="number" id="${prefix}Value1" min="0" max="127" value="${v1}" oninput="updateAction('${prefix}')"></div><div class="form-group"><label class="form-label">${t.channel}</label><input type="number" id="${prefix}Channel" min="1" max="16" value="${ch}" oninput="updateAction('${prefix}')"></div></div>`; }
  else if(actionType===5 && macro){ html=renderMacroEditor(prefix,macro); }
  document.getElementById(prefix+'Params').innerHTML=html;
}

function renderMacroEditor(prefix,macro){
  const t=i18n[currentLang]; let html='<div class="macro-container">';
  for(let i=0;i<3;i++){ 
    const s=macro && macro[i] ? macro[i] : {type:0,delay:1000,value1:0,value2:0,value3:1}; 
    const en=s.type>0; const sid=`${prefix}_step_${i}`;
    html+=`<div class="macro-step ${en?'':'disabled'}" id="${sid}_container"><div class="macro-step-header"><span class="macro-step-title">${t.step} ${i+1}</span><label class="toggle" style="transform:scale(0.8)"><input type="checkbox" id="${sid}_enabled" ${en?'checked':''} onchange="toggleMacroStep('${prefix}',${i})"><span class="toggle-slider"></span></label></div><div class="macro-step-content" id="${sid}_content" ${en?'':'style="display:none"'}><div class="form-group"><div class="slider-label"><span>${t.delay}</span><span class="slider-value" id="${sid}_delay_value">${(s.delay/1000).toFixed(1)} sec</span></div><input type="range" id="${sid}_delay" min="0" max="5000" step="100" value="${s.delay}" oninput="updateMacroDelay('${prefix}',${i})"></div><div class="form-group"><label class="form-label">${t.type}</label><select id="${sid}_type" onchange="onMacroTypeChange('${prefix}',${i})"><option value="1" ${s.type===1?'selected':''}>${t.keyboard}</option><option value="2" ${s.type===2?'selected':''}>${t.mediaKey}</option><option value="3" ${s.type===3?'selected':''}>${t.midiNote}</option><option value="4" ${s.type===4?'selected':''}>${t.midiCC}</option><option value="5" ${s.type===5?'selected':''}>${t.midiPC}</option></select></div><div id="${sid}_params">${renderMacroStepParams(prefix,i,s)}</div></div></div>`;
  }
  return html+'</div>';
}
function renderMacroStepParams(prefix,idx,s){
  const sid=`${prefix}_step_${idx}`; const t=i18n[currentLang];
  if(!s || s.type===0){ return''; }
  if(s.type===1){ let opts=''; for(const c of Object.values(keyCategories)){opts+=`<optgroup label="${c.name}">${c.keys.map(k=>`<option value="${k.value}" ${k.value===s.value1?'selected':''}>${k.name}</option>`).join('')}</optgroup>`;} return`<div class="form-group"><label class="form-label">${t.key}</label><select id="${sid}_value1" onchange="updateMacroValue('${prefix}',${idx})">${opts}</select></div><div class="modifier-row"><label class="modifier-check"><input type="checkbox" id="${sid}_ctrl" ${s.value2&1?'checked':''} onchange="updateMacroMod('${prefix}',${idx})">Ctrl</label><label class="modifier-check"><input type="checkbox" id="${sid}_alt" ${s.value2&2?'checked':''} onchange="updateMacroMod('${prefix}',${idx})">Alt</label><label class="modifier-check"><input type="checkbox" id="${sid}_shift" ${s.value2&4?'checked':''} onchange="updateMacroMod('${prefix}',${idx})">Shift</label><label class="modifier-check"><input type="checkbox" id="${sid}_gui" ${s.value2&8?'checked':''} onchange="updateMacroMod('${prefix}',${idx})">Win</label></div>`; }
  if(s.type===2){ return`<div class="form-group"><label class="form-label">${t.mediaKeyLabel}</label><select id="${sid}_value1" onchange="updateMacroValue('${prefix}',${idx})">${mediaKeys.map(k=>`<option value="${k.value}" ${k.value===s.value1?'selected':''}>${k.name}</option>`).join('')}</select></div>`; }
  if(s.type===3){ return`<div class="form-row-3"><div class="form-group"><label class="form-label">${t.note}</label><input type="number" id="${sid}_value1" min="0" max="127" value="${s.value1}" oninput="updateMacroValue('${prefix}',${idx})"></div><div class="form-group"><label class="form-label">${t.velocity}</label><input type="number" id="${sid}_value2" min="0" max="127" value="${s.value2}" oninput="updateMacroValue('${prefix}',${idx})"></div><div class="form-group"><label class="form-label">${t.channel}</label><input type="number" id="${sid}_value3" min="1" max="16" value="${s.value3}" oninput="updateMacroValue('${prefix}',${idx})"></div></div>`; }
  if(s.type===4){ return`<div class="form-row-3"><div class="form-group"><label class="form-label">${t.ccNumber}</label><input type="number" id="${sid}_value1" min="0" max="127" value="${s.value1}" oninput="updateMacroValue('${prefix}',${idx})"></div><div class="form-group"><label class="form-label">${t.value}</label><input type="number" id="${sid}_value2" min="0" max="127" value="${s.value2}" oninput="updateMacroValue('${prefix}',${idx})"></div><div class="form-group"><label class="form-label">${t.channel}</label><input type="number" id="${sid}_value3" min="1" max="16" value="${s.value3}" oninput="updateMacroValue('${prefix}',${idx})"></div></div>`; }
  if(s.type===5){ return`<div class="form-row"><div class="form-group"><label class="form-label">${t.programNumber}</label><input type="number" id="${sid}_value1" min="0" max="127" value="${s.value1}" oninput="updateMacroValue('${prefix}',${idx})"></div><div class="form-group"><label class="form-label">${t.channel}</label><input type="number" id="${sid}_value3" min="1" max="16" value="${s.value3}" oninput="updateMacroValue('${prefix}',${idx})"></div></div>`; }
  return'';
}

function toggleMacroStep(prefix,idx){ const b=buttons[selectedBtn]; const m=prefix==='short'?b.shortMacro:b.longMacro; if(!m||!m[idx])return; const sid=`${prefix}_step_${idx}`; const cb=document.getElementById(`${sid}_enabled`); const cont=document.getElementById(`${sid}_container`); const content=document.getElementById(`${sid}_content`); if(cb.checked){m[idx].type=1;m[idx].delay=1000;m[idx].value1=97;m[idx].value2=0;m[idx].value3=1;cont.classList.remove('disabled');content.style.display='';}else{m[idx].type=0;cont.classList.add('disabled');content.style.display='none';} document.getElementById(`${sid}_params`).innerHTML=renderMacroStepParams(prefix,idx,m[idx]); const ds=document.getElementById(`${sid}_delay`); const dv=document.getElementById(`${sid}_delay_value`); if(ds&&dv){ds.value=m[idx].delay;dv.textContent=(m[idx].delay/1000).toFixed(1)+' sec';} sendConfigDelayed(); }
function onMacroTypeChange(prefix,idx){ const b=buttons[selectedBtn]; const m=prefix==='short'?b.shortMacro:b.longMacro; if(!m||!m[idx])return; const sid=`${prefix}_step_${idx}`; m[idx].type=parseInt(document.getElementById(`${sid}_type`).value); m[idx].value1=m[idx].type===3?61:0;m[idx].value2=m[idx].type===3?127:0;m[idx].value3=1; document.getElementById(`${sid}_params`).innerHTML=renderMacroStepParams(prefix,idx,m[idx]); sendConfigDelayed(); }
function updateMacroDelay(prefix,idx){ const b=buttons[selectedBtn]; const m=prefix==='short'?b.shortMacro:b.longMacro; if(!m||!m[idx])return; const sid=`${prefix}_step_${idx}`; m[idx].delay=parseInt(document.getElementById(`${sid}_delay`).value); document.getElementById(`${sid}_delay_value`).textContent=(m[idx].delay/1000).toFixed(1)+' sec'; sendConfigDelayed(); }
function updateMacroValue(prefix,idx){ const b=buttons[selectedBtn]; const m=prefix==='short'?b.shortMacro:b.longMacro; if(!m||!m[idx])return; const sid=`${prefix}_step_${idx}`; const v1=document.getElementById(`${sid}_value1`); const v2=document.getElementById(`${sid}_value2`); const v3=document.getElementById(`${sid}_value3`); if(v1)m[idx].value1=parseInt(v1.value)||0; if(v2)m[idx].value2=parseInt(v2.value)||0; if(v3)m[idx].value3=parseInt(v3.value)||1; sendConfigDelayed(); }
function updateMacroMod(prefix,idx){ const b=buttons[selectedBtn]; const m=prefix==='short'?b.shortMacro:b.longMacro; if(!m||!m[idx])return; const sid=`${prefix}_step_${idx}`; let mod=0; if(document.getElementById(`${sid}_ctrl`)?.checked)mod|=1; if(document.getElementById(`${sid}_alt`)?.checked)mod|=2; if(document.getElementById(`${sid}_shift`)?.checked)mod|=4; if(document.getElementById(`${sid}_gui`)?.checked)mod|=8; m[idx].value2=mod; sendConfigDelayed(); }

async function toggleConnection(){ port?await disconnect():await connect(); }
async function connect(){ 
  const t=i18n[currentLang];
  try{ 
    port=await navigator.serial.requestPort(); 
    await port.open({baudRate:115200}); 
    log(t.connected+'!','info'); 
    updateConnectionUI(true); 
    const enc=new TextEncoderStream();enc.readable.pipeTo(port.writable);writer=enc.writable.getWriter(); 
    const dec=new TextDecoderStream();port.readable.pipeTo(dec.writable);reader=dec.readable.getReader(); 
    setTimeout(()=>sendCommand('GET'),500); 
    readLoop(); 
  }catch(e){log(t.connectionFailed+e.message,'info');} 
}
async function disconnect(){ 
  const t=i18n[currentLang];
  try{
    if(reader){await reader.cancel();reader=null;}
    if(writer){await writer.close();writer=null;}
    if(port){await port.close();port=null;}
    log(t.disconnected,'info');
    updateConnectionUI(false);
  }catch(e){} 
}
function updateConnectionUI(c){ 
  const t=i18n[currentLang]; 
  document.getElementById('statusDot').classList.toggle('connected',c); 
  document.getElementById('statusText').textContent=c?t.connected:t.disconnected; 
  const btn=document.getElementById('connectBtn'); 
  btn.textContent=c?t.disconnect:t.connect; 
  btn.className='btn '+(c?'btn-disconnect':'btn-connect'); 
  document.getElementById('loadDeviceBtn').disabled=!c;
  document.getElementById('saveBtn').disabled=!c; 
  document.getElementById('presetCard').classList.toggle('hidden',!c);
  document.getElementById('buttonStatusCard').classList.toggle('hidden',!c);
  document.getElementById('configCard').classList.toggle('hidden',!c);
  if(!c){ setUnsaved(false); dataLoaded=false; selectedPreset=-1; renderPresets(); renderButtonGrid(); }
  updateConfigCardState();
}
async function readLoop(){ let buf=''; try{while(true){const{value,done}=await reader.read();if(done)break;buf+=value;const lines=buf.split('\n');buf=lines.pop();for(const l of lines){const tr=l.trim();if(tr)processResponse(tr);}}}catch(e){} }
function processResponse(r){ 
  const t=i18n[currentLang];
  log('â† '+r,'rx'); 
  if(r==='SAVED'){setUnsaved(false);log(t.savedToEeprom,'info');} 
  else if(r.startsWith('CFG:')){
    const parts=r.substring(4).split(',').map(x=>parseInt(x));
    if(parts.length>=13){
      const i=parts[0];
      if(i>=0 && i<6){
        buttons[i].mode=parts[1];
        buttons[i].longPressTime=parts[2];
        buttons[i].shortEnabled=parts[3];
        buttons[i].shortType=parts[4];
        buttons[i].shortValue1=parts[5];
        buttons[i].shortValue2=parts[6];
        buttons[i].shortChannel=parts[7];
        buttons[i].longEnabled=parts[8];
        buttons[i].longType=parts[9];
        buttons[i].longValue1=parts[10];
        buttons[i].longValue2=parts[11];
        buttons[i].longChannel=parts[12];
        dataLoaded=true;
        updateConfigCardState();
        renderButtonGrid(); updateConfigUI(); 
        log('âœ… BTN'+(i+1)+' '+t.configLoaded,'info');
      }
    }
  }
  else if(r.startsWith('MCFG:')){
    const parts=r.substring(5).split(',').map(x=>parseInt(x));
    if(parts.length>=8){
      const btnIdx=parts[0], isShort=parts[1], stepIdx=parts[2];
      if(btnIdx>=0 && btnIdx<6 && stepIdx>=0 && stepIdx<3){
        const m=isShort ? buttons[btnIdx].shortMacro : buttons[btnIdx].longMacro;
        m[stepIdx].delay=parts[3];
        m[stepIdx].type=parts[4];
        m[stepIdx].value1=parts[5];
        m[stepIdx].value2=parts[6];
        m[stepIdx].value3=parts[7];
        if(dataLoaded){ renderButtonGrid(); updateConfigUI(); }
      }
    }
  }
}
async function sendCommand(cmd){ if(!writer)return; try{await writer.write(cmd+'\n');log('â†’ '+cmd,'tx');}catch(e){} }
function sendConfigDelayed(){ clearTimeout(sendTimeout); sendTimeout=setTimeout(async ()=>{await sendAllConfig();setUnsaved(true);},300); }
async function sendAllConfig(){ 
  for(let i=0;i<6;i++){ 
    const b=buttons[i]; 
    let cmd=`CFG:${i},${b.mode},${b.longPressTime},${b.shortEnabled},${b.shortType},${b.shortValue1},${b.shortValue2},${b.shortChannel},${b.longEnabled},${b.longType},${b.longValue1},${b.longValue2},${b.longChannel}`; 
    await sendCommand(cmd);
    for(let j=0;j<3;j++){
      if(b.shortMacro && b.shortMacro[j] && b.shortMacro[j].type>0){
        const m=b.shortMacro[j];
        await sendCommand(`MCFG:${i},1,${j},${m.delay},${m.type},${m.value1},${m.value2},${m.value3}`);
      }
      if(b.longMacro && b.longMacro[j] && b.longMacro[j].type>0){
        const m=b.longMacro[j];
        await sendCommand(`MCFG:${i},0,${j},${m.delay},${m.type},${m.value1},${m.value2},${m.value3}`);
      }
    }
  } 
}
async function saveToDevice(){ if(!writer)return; clearTimeout(sendTimeout); await sendCommand('SAVE'); }
async function loadFromDevice(){ 
  if(!writer)return; 
  const t=i18n[currentLang];
  log('ğŸ“¥ '+(currentLang==='ko'?'ì¥ì¹˜ì—ì„œ ì„¤ì • ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...':'Loading config from device...'),'info');
  await sendCommand('GET'); 
  setUnsaved(false);
}
function setUnsaved(v){ 
  const t=i18n[currentLang];
  document.getElementById('unsavedBadge').classList.toggle('hidden',!v); 
  document.getElementById('unsavedBadge').textContent=t.unsaved;
  document.getElementById('saveBtn').classList.toggle('unsaved',v); 
}
function log(msg,type='info'){ const d=document.getElementById('log'); const e=document.createElement('div'); e.className='log-entry '+type; e.textContent='['+new Date().toLocaleTimeString()+'] '+msg; d.appendChild(e); d.scrollTop=d.scrollHeight; }

init();
</script>
</body>
</html>
